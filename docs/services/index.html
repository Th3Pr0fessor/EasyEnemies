<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Services | EasyEnemies</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://Th3Pr0fessor.github.io/EasyEnemies/docs/services"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Services | EasyEnemies"><meta data-react-helmet="true" name="description" content="Services Defined"><meta data-react-helmet="true" property="og:description" content="Services Defined"><link data-react-helmet="true" rel="shortcut icon" href="/EasyEnemies/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://Th3Pr0fessor.github.io/EasyEnemies/docs/services"><link data-react-helmet="true" rel="alternate" href="https://Th3Pr0fessor.github.io/EasyEnemies/docs/services" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://Th3Pr0fessor.github.io/EasyEnemies/docs/services" hreflang="x-default"><link rel="stylesheet" href="/EasyEnemies/assets/css/styles.fb20d3d5.css">
<link rel="preload" href="/EasyEnemies/assets/js/runtime~main.7864da3f.js" as="script">
<link rel="preload" href="/EasyEnemies/assets/js/main.e1d6d83a.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/EasyEnemies/"><b class="navbar__title">EasyEnemies</b></a><a class="navbar__item navbar__link navbar__link--active" href="/EasyEnemies/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/EasyEnemies/api/">API</a><a class="navbar__item navbar__link" href="/EasyEnemies/changelog">Changelog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Sleitnick/Knit" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ðŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ðŸŒž</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Press S to Search..." aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/EasyEnemies/docs/intro">About</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/EasyEnemies/docs/gettingstarted">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/EasyEnemies/docs/services">Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/EasyEnemies/docs/controllers">Controllers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/EasyEnemies/docs/util">Util</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/EasyEnemies/docs/executionmodel">Execution Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/EasyEnemies/docs/examples">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/EasyEnemies/docs/middleware">Middleware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/EasyEnemies/docs/vscodesnippets">VS Code Snippets</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Services</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="services-defined">Services Defined<a aria-hidden="true" class="hash-link" href="#services-defined" title="Direct link to heading">â€‹</a></h2><p>Services are singleton provider objects that serve a specific purpose on the server. For instance, a game might have a PointsService, which manages in-game points for the players.</p><p>A game might have many services. They will serve as the backbone of a game.</p><p>For the sake of example, we will slowly develop PointsService to show how a service is constructed.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="creating-services">Creating Services<a aria-hidden="true" class="hash-link" href="#creating-services" title="Direct link to heading">â€‹</a></h2><p>In its simplest form, a service can be created like so:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">local PointsService = Knit.CreateService { Name = &quot;PointsService&quot;, Client = {} }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return PointsService</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Client table optional</h5></div><div class="admonition-content"><p>The <code>Client</code> table is optional for the constructor. However, it will be added by Knit if left out. For the sake of code clarity, it is recommended to keep it in the constructor as shown above.</p></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>No client table forces server-only mode</h5></div><div class="admonition-content"><p>If the <code>Client</code> table is omitted, the service will be interpreted as server-side only. This means that the client will <em>not</em> be able to access this service using <code>Knit.GetService</code> on the client.</p></div></div><p>The <code>Name</code> field is required. This name is how code outside of your service will find it. This name must be unique from all other services. It is best practice to name your variable the same as the service name (e.g. <code>local PointsService</code> matches <code>Name = &quot;PointsService&quot;</code>).</p><p>The last line (<code>return PointsService</code>) assumes this code is written in a ModuleScript, which is best practice for containing services.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="adding-methods">Adding methods<a aria-hidden="true" class="hash-link" href="#adding-methods" title="Direct link to heading">â€‹</a></h2><p>Services are just simple tables at the end of the day. As such, it is very easy to add methods to services.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:AddPoints(player, amount)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- TODO: add points</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="adding-properties">Adding properties<a aria-hidden="true" class="hash-link" href="#adding-properties" title="Direct link to heading">â€‹</a></h2><p>Again, services are just tables. So we can simply add in properties as we want. In our above method, we are returning <code>0</code> for <code>GetPoints()</code> because we have nowhere to store/retrieve points. Likewise, our <code>AddPoints()</code> method can&#x27;t do anything. Let&#x27;s change that. Let&#x27;s create a property that holds a table of points per player:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService.PointsPerPlayer = {}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="using-methods-and-properties">Using methods and properties<a aria-hidden="true" class="hash-link" href="#using-methods-and-properties" title="Direct link to heading">â€‹</a></h2><p>Now we can change our <code>AddPoints()</code> and <code>GetPoints()</code> methods to use this field.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService.PointsPerPlayer = {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:AddPoints(player, amount)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local points = self:GetPoints(player) -- Current amount of points</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    points += amount                      -- Add points</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self.PointsPerPlayer[player] = points -- Store points</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local points = self.PointsPerPlayer[player]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return points or 0 -- Return 0 if no points found for player</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="using-events">Using events<a aria-hidden="true" class="hash-link" href="#using-events" title="Direct link to heading">â€‹</a></h2><p>What if we want to fire an event when the amount of points changes? This is easy. We can assign an event named <code>PointsChanged</code> as a property of our service, and have our <code>AddPoints()</code> method fire the event:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Load the Signal module and create PointsChanged signal:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local Signal = require(Knit.Util.Signal)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService.PointsChanged = Signal.new()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Modify AddPoints:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:AddPoints(player, amount)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local points = self:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    points += amount</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self.PointsPerPlayer[player] = points</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- Fire event signal, as long as we actually changed the points:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (amount ~= 0) then</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.PointsChanged:Fire(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Another service could then listen for the changes on that event:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function SomeOtherService:KnitStart()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local PointsService = Knit.GetService(&quot;PointsService&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    PointsService.PointsChanged:Connect(function(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(&quot;Points changed for &quot; .. player.Name .. &quot;:&quot;, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="knitinit-and-knitstart">KnitInit and KnitStart<a aria-hidden="true" class="hash-link" href="#knitinit-and-knitstart" title="Direct link to heading">â€‹</a></h2><p>In that last code snippet, there&#x27;s an odd <code>KnitStart()</code> method. This is part of the Knit lifecycle (read more under <a href="/EasyEnemies/docs/executionmodel">execution model</a>). These methods are optional, but very useful for orchestrating communication between other services.</p><p>When a service is first created, it is not guaranteed that other services are also created and ready to be used. The <code>KnitInit</code> and <code>KnitStart</code> methods come to save the day! After all services are created and the <code>Knit.Start()</code> method is fired, the <code>KnitInit</code> methods of all services will be fired.</p><p>From the <code>KnitInit</code> method, we can guarantee that all other services have been created. However, we still cannot guarantee that those services are ready to be consumed. Therefore, we can <em>reference</em> them within the <code>Init</code> step, but we should never <em>use</em> them (e.g. use the methods or events attached to those other services).</p><p>After all <code>KnitInit</code> methods have finished, all <code>KnitStart</code> methods are then fired. At this point, we can guarantee that all <code>KnitInits</code> are done, and thus can freely access other services.</p><p>In order to maintain this pattern, be sure to set up your service in the <code>Init</code> method (or earlier; just in the ModuleScript itself). By the time <code>KnitStart</code> methods are being fired, your services should be available for use.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="cleaning-up-unused-memory">Cleaning Up Unused Memory<a aria-hidden="true" class="hash-link" href="#cleaning-up-unused-memory" title="Direct link to heading">â€‹</a></h2><p>Alright, back to our PointsService! We have a problem... We have created a <a href="https://en.wikipedia.org/wiki/Memory_leak" target="_blank" rel="noopener noreferrer">memory leak</a>! When we add points for a player, we add the player to the table. What happens when the player leaves? Nothing! And that&#x27;s a problem. That player&#x27;s data is forever held onto within that <code>PointsPerPlayer</code> table. To fix this, we need to clear out that data when the player leaves. We can use the <code>KnitInit</code> method to hook up to the <code>Players.PlayerRemoving</code> event and remove the data:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:KnitInit()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    game:GetService(&quot;Players&quot;).PlayerRemoving:Connect(function(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        -- Clear out the data for the player when the player leaves:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.PointsPerPlayer[player] = nil</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>While memory management is not unique to Knit, it is still an important aspect to consider when making your game. Even a garbage-collected language like Lua can have memory leaks introduced by the developer.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="client-communication">Client Communication<a aria-hidden="true" class="hash-link" href="#client-communication" title="Direct link to heading">â€‹</a></h2><p>Alright, so we can store and add points on the server for a player. But who cares? Players have no visibility to these points at the moment. We need to open a line of communication between our service and the clients (AKA players). This functionality is so fundamental to Knit, that it&#x27;s where the name came from: The need to <em>knit</em> together communication.</p><p>This is where we are going to use that <code>Client</code> table defined at the beginning.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="methods">Methods<a aria-hidden="true" class="hash-link" href="#methods" title="Direct link to heading">â€‹</a></h3><p>Let&#x27;s say that we want to create a method that lets players fetch how many points they have, and when their points change. First, let&#x27;s make a method to fetch points:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService.Client:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- We can just call our other method from here:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return self.Server:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This creates a client-exposed method called <code>GetPoints</code>. Within it, we reach back to our top-level service using <code>self.Server</code> and then invoke our other <code>GetPoints</code> method that we wrote before. In this example, we&#x27;ve basically just created a proxy for another method; however, this will not always be the case. There will be many times where a client method will exist alone without an equivalent server-side-only method.</p><p>Under the hood, Knit will create a RemoteFunction and bind this method to it.</p><p>On the client, we could then invoke the service as such:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- From a LocalScript</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local Knit = require(game:GetService(&quot;ReplicatedStorage&quot;).Packages.Knit)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local PointsService = Knit.GetService(&quot;PointsService&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService:GetPoints():andThen(function(points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(&quot;Points for myself:&quot;, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="signals-server-to-client">Signals (Server-to-Client)<a aria-hidden="true" class="hash-link" href="#signals-server-to-client" title="Direct link to heading">â€‹</a></h3><p>We should also create a signal that we can fire events for the clients when their points change. We can use <code>Knit:CreateSignal()</code> to indicate we want a signal created for the service.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">local PointsService = Knit.CreateService {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Name = &quot;PointsService&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Client = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        PointsChanged = Knit.CreateSignal(), -- Create the signal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Remote Signal</h5></div><div class="admonition-content"><p>See the <a href="https://sleitnick.github.io/RbxUtil/api/RemoteSignal" target="_blank" rel="noopener noreferrer">RemoteSignal</a> documentation for more info on how to use the RemoteSignal object.</p></div></div><p>Under the hood, Knit is using the <code>Comm</code> module, which is creating a RemoteEvent object linked to this event. This is a two-way signal (like a transceiver), so we can both send and receive data on both the server and the client.</p><p>We can then modify our <code>AddPoints</code> method again to fire this signal too:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:AddPoints(player, amount)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local points = self:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    points += amount</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self.PointsPerPlayer[player] = points</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if amount ~= 0 then</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.PointsChanged:Fire(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        -- Fire the client signal:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.Client.PointsChanged:Fire(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And from the client, we can listen for an event on the signal:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- From a LocalScript</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local Knit = require(game:GetService(&quot;ReplicatedStorage&quot;).Packages.Knit)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local PointsService = Knit.GetService(&quot;PointsService&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService.PointsChanged:Connect(function(points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(&quot;Points for myself now:&quot;, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="signals-client-to-server">Signals (Client-to-Server)<a aria-hidden="true" class="hash-link" href="#signals-client-to-server" title="Direct link to heading">â€‹</a></h3><p>Signal events can also be fired from the client. This is useful when the client needs to give the server information, but doesn&#x27;t care about any response from the server. For instance, maybe the client wants to tell the PointsService that it wants some points. This is an odd use-case, but let&#x27;s just roll with it.</p><p>We will create another client-exposed signal called <code>GiveMePoints</code> which will randomly give the player points. Again, this is nonsense in the context of an actual game, but useful for example.</p><p>Let&#x27;s create the signal on the PointsService:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">local PointsService = Knit.CreateService {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Name = &quot;PointsService&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Client = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        PointsChanged = Knit.CreateSignal(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        GiveMePoints = Knit.CreateSignal(), -- Create the new signal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now, let&#x27;s listen for the client to fire this signal. We can hook this up in our <code>KnitInit</code> method:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:KnitInit()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local rng = Random.new()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- Listen for the client to fire this signal, then give random points:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self.Client.GiveMePoints:Connect(function(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        local points = rng:NextInteger(0, 10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self:AddPoints(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(&quot;Gave &quot; .. player.Name .. &quot; &quot; .. points .. &quot; points&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- ...other code for cleaning up player data here</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>From the client, we can fire the signal like so:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- From a LocalScript</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local Knit = require(game:GetService(&quot;ReplicatedStorage&quot;).Packages.Knit)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local PointsService = Knit.GetService(&quot;PointsService&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Fire the signal:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService.GiveMePoints:Fire()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Client Remote Signal</h5></div><div class="admonition-content"><p>See the <a href="https://sleitnick.github.io/RbxUtil/api/ClientRemoteSignal" target="_blank" rel="noopener noreferrer">ClientRemoteSignal</a> documentation for more info on how to use the ClientRemoteSignal object.</p></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="properties">Properties<a aria-hidden="true" class="hash-link" href="#properties" title="Direct link to heading">â€‹</a></h3><p>It is often useful to replicate data to all or individual players. Instead of creating methods and signals to communicate this data, RemoteProperties
can be used.</p><p>For example, let&#x27;s refactor the <code>AddPoints</code> method to set a RemoteProperty of the number of points the player has. The client will then be able to
easily read this property:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Create the RemoteProperty:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService.Client.Points = Knit.CreateProperty(0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:AddPoints(player, amount)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local points = self:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    points += amount</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self.PointsPerPlayer[player] = points</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self.Client.Points:SetFor(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>On the client, we can now easily read the <code>Points</code> property:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- LocalScript</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local Knit = require(game:GetService(&quot;ReplicatedStorage&quot;).Packages.Knit)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local PointsService = Knit.GetService(&quot;PointsService&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- The &#x27;Observe&#x27; method will fire for the current value and any time the value changes:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService.Points:Observe(function(points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(&quot;Current number of points:&quot;, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Using <code>Observe</code> is the easiest way to track the value of a RemoteProperty on the client.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Remote Property</h5></div><div class="admonition-content"><p>See the <a href="https://sleitnick.github.io/RbxUtil/api/RemoteProperty" target="_blank" rel="noopener noreferrer">RemoteProperty</a> and
<a href="https://sleitnick.github.io/RbxUtil/api/ClientRemoteProperty" target="_blank" rel="noopener noreferrer">ClientRemoteProperty</a>
documentation for more info on how to use the RemoteProperty and ClientRemoteProperty objects.</p></div></div><hr><h2 class="anchor anchorWithStickyNavbar_31ik" id="full-example">Full Example<a aria-hidden="true" class="hash-link" href="#full-example" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="pointsservice">PointsService<a aria-hidden="true" class="hash-link" href="#pointsservice" title="Direct link to heading">â€‹</a></h3><p>At the end of this tutorial, we should have a PointsService that looks something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">local Knit = require(game:GetService(&quot;ReplicatedStorage&quot;).Packages.Knit)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local Signal = require(Knit.Util.Signal)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local PointsService = Knit.CreateService {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Name = &quot;PointsService&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- Define some properties:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    PointsPerPlayer = {},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    PointsChanged = Signal.new(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Client = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        -- Expose signals to the client:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        PointsChanged = Knit.CreateSignal(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        GiveMePoints = Knit.CreateSignal(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Points = Knit.CreateProperty(0),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Client exposed GetPoints method:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService.Client:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return self.Server:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Add Points:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:AddPoints(player, amount)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local points = self:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    points += amount</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self.PointsPerPlayer[player] = points</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if amount ~= 0 then</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.PointsChanged:Fire(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.Client.PointsChanged:Fire(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self.Client.Points:SetFor(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Get Points:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:GetPoints(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local points = self.PointsPerPlayer[player]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return points or 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Initialize</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function PointsService:KnitInit()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local rng = Random.new()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- Give player random amount of points:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self.Client.GiveMePoints:Connect(function(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        local points = rng:NextInteger(0, 10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self:AddPoints(player, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(&quot;Gave &quot; .. player.Name .. &quot; &quot; .. points .. &quot; points&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -- Clean up data when player leaves:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    game:GetService(&quot;Players&quot;).PlayerRemoving:Connect(function(player)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.PointsPerPlayer[player] = nil</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    end)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return PointsService</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="client-consumer">Client Consumer<a aria-hidden="true" class="hash-link" href="#client-consumer" title="Direct link to heading">â€‹</a></h3><p>Example of client-side LocalScript consuming the PointsService:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly lua"><pre tabindex="0" class="prism-code language-lua codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- From a LocalScript</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local Knit = require(game:GetService(&quot;ReplicatedStorage&quot;).Packages.Knit)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Knit.Start():catch(warn):await()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local PointsService = Knit.GetService(&quot;PointsService&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local function PointsChanged(points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(&quot;My points:&quot;, points)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Get points and listen for changes:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService:GetPoints():andThen(PointsChanged)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService.PointsChanged:Connect(PointsChanged)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Ask server to give points randomly:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PointsService.GiveMePoints:Fire()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Sleitnick/Knit/edit/master/docs/services.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/EasyEnemies/docs/gettingstarted"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Getting Started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/EasyEnemies/docs/controllers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Controllers<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#services-defined" class="table-of-contents__link toc-highlight">Services Defined</a></li><li><a href="#creating-services" class="table-of-contents__link toc-highlight">Creating Services</a></li><li><a href="#adding-methods" class="table-of-contents__link toc-highlight">Adding methods</a></li><li><a href="#adding-properties" class="table-of-contents__link toc-highlight">Adding properties</a></li><li><a href="#using-methods-and-properties" class="table-of-contents__link toc-highlight">Using methods and properties</a></li><li><a href="#using-events" class="table-of-contents__link toc-highlight">Using events</a></li><li><a href="#knitinit-and-knitstart" class="table-of-contents__link toc-highlight">KnitInit and KnitStart</a></li><li><a href="#cleaning-up-unused-memory" class="table-of-contents__link toc-highlight">Cleaning Up Unused Memory</a></li><li><a href="#client-communication" class="table-of-contents__link toc-highlight">Client Communication</a><ul><li><a href="#methods" class="table-of-contents__link toc-highlight">Methods</a></li><li><a href="#signals-server-to-client" class="table-of-contents__link toc-highlight">Signals (Server-to-Client)</a></li><li><a href="#signals-client-to-server" class="table-of-contents__link toc-highlight">Signals (Client-to-Server)</a></li><li><a href="#properties" class="table-of-contents__link toc-highlight">Properties</a></li></ul></li><li><a href="#full-example" class="table-of-contents__link toc-highlight">Full Example</a><ul><li><a href="#pointsservice" class="table-of-contents__link toc-highlight">PointsService</a></li><li><a href="#client-consumer" class="table-of-contents__link toc-highlight">Client Consumer</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Th3Pr0fessor. Built with Moonwave and Docusaurus.</div></div></div></footer></div>
<script src="/EasyEnemies/assets/js/runtime~main.7864da3f.js"></script>
<script src="/EasyEnemies/assets/js/main.e1d6d83a.js"></script>
</body>
</html>